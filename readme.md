Problem Быстрое транспонирование
Input file name: standard input
Output file name: standard output
Time limit: 4 s
Memory limit: 512 MB


В этой задаче вам потребуется выполнить несколько операций транспонирования квадратной подматрицы данной матрицы A. Матрицу A будет представлять линейным массивом d, т.е. Ai, j = di·n + j. Индексация строк и столбцов матрицы A начинается с 0.

Так как наша цель быстро выполнять именно операцию транспонирования, то входную матрицу нужно сгенерировать следующим генератором:


vector<int> generate_input(int n, int seed) {
    vector<int> d(n * n);
    for (size_t i = 0; i < d.size(); ++i) {
        d[i] = seed;
        seed = ((long long) seed * 197 + 2017) & 987654;
    }
    return d;
}
Кроме этого выводить в результате саму матрицу не требуется, а нужно вывести только результат работы следующей функции:


long long get_hash(const vector<int>& d) {
    const long long MOD = 987654321054321LL;
    const long long MUL = 179;

    long long result_value = 0;
    for (size_t i = 0; i < d.size(); ++i)
        result_value = (result_value * MUL + d[i]) & MOD;
    return result_value;
}
Входные данные
В первой строке входных данных записаны два целых числа n и seed (1 ≤ n, seed ≤ 10000).

Вторая строка содержит число k (1 ≤ k ≤ 10) — количество операций транспонирования.

Каждая из последующих k строк содержит описание подматрицы, которую нужно транспонировать: imin, jmin и side (0 ≤ imin, jmin < n, 1 ≤ size ≤ n - max{imin, jmin}).

Выходные данные
Выведите только результат вызова функции get_hash с параметром d равным результату транспонирования исходной матрицы k раз.

Примеры

входные данные
3 10
1
0 0 3
выходные данные
537985024
входные данные
3 1
3
0 0 3
0 1 2
1 0 2
выходные данные
5570561
входные данные
1111 111
1
11 1 111
выходные данные
985162958569569